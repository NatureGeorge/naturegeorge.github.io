---
layout: post
title: Ways to compute dihedrals
date: 2022-07-16 14:20:00+0800
categories: coding
description: A brief record.
authors:
  - name: Zefeng Zhu
    affiliations:
      name: AAIS, PKU
---

{% highlight python linenos %}

import numpy

def dihedral(coord0, coord1, coord2, coord3):
    b = coord2 - coord1
    u = np.cross(b, coord1 - coord0)
    w = np.cross(b, coord2 - coord3)
    return np.arctan2(np.cross(u, w).dot(b), u.dot(w) * np.linalg.norm(b))

{% endhighlight %}
